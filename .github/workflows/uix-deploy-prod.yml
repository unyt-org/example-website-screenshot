# This file was auto generated by the uix git_deploy plugin. Do not manually edit.

name: Deploy prod
on: push
env:
  GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: "actions/checkout@v3"
      - name: Setup Deno
        uses: "denoland/setup-deno@v1"
      - name: Run Tests
        run: "deno run -Aq --import-map https://dev.cdn.unyt.org/importmap.json https://dev.cdn.unyt.org/unyt_tests/run.ts -s --reportfile testreport.xml"
      - name: Publish Test Report
        uses: "mikepenz/action-junit-report@v3"
        if: "success() || failure()"
        with:
          report_paths: testreport.xml
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: "actions/checkout@v3"
      - name: Setup Deno
        uses: "denoland/setup-deno@v1"
      - name: Deploy UIX App
        run: "deno run --importmap https://dev.cdn.unyt.org/uix1/importmap.json -Aqr https://dev.cdn.unyt.org/uix1/run.ts --stage prod --detach "
    needs: test
